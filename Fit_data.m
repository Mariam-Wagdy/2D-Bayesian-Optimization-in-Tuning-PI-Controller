clc;
clear;

Kp=[100*ones(10,1);200*ones(10,1);300*ones(10,1);400*ones(10,1);...
    500*ones(10,1);600*ones(10,1);700*ones(10,1);800*ones(10,1);900*ones(10,1);1000*ones(10,1)];
r=[100; 200 ;300; 400 ;500 ;600 ;700 ;800; 900 ;1000];

Ki = [r;r;r;r;r;r;r;r;r;r];
ST = [97.7398 56.7124 42.3958 34.1355 30.825 28.8498 27.3257 26.0583...
    28.4762 27.5025 99.9838 57.6394 43.2202 35.7994 31.1563 28.2281 ...
    25.8804 22.8428 21.5136 20.5035 102.2272 58.5852 43.7766 36.1732...
    31.4594 28.2164 25.7856 23.8274 22.2256 20.9403 104.4678 59.536 ...
    44.3347 36.5522 31.7408 28.4219 25.9598 24.0357 22.4759 21.1809 ...
    106.7034 60.4909 44.8965 36.9343 32.0235 28.6425 26.1405 24.1924 ...
    22.618 21.3095 108.9328 61.4489 45.462 37.3194 32.3087 28.8658 ...
    26.3227 24.3459 22.7504 21.4251 111.1544 62.4093 46.0306 37.707 ...
    32.5958 29.0908 26.5059 24.4998 22.8827 21.5409 113.3671 63.3717 ...
    46.6021 38.0971 32.8851 29.3174 26.6907 24.655 23.016 21.6574 ...
    115.5698 64.3351 47.176 38.4895 33.1763 29.5457 26.8768 24.8112 ...
    23.1501 21.7746 117.7616 65.299 47.752 38.8842 33.4694 29.7754 ...
    27.0641 24.9684 23.2851 21.8926];
ST=ST';

Tb = table(Kp,Ki,ST);
ResponseVarName=ST;
gprMdl = fitrgp(Tb,'ST','KernelFunction','ardrationalquadratic');%fitrgp(Tbl,ResponseVarName);
%"exponential' 'squaredexponential' 'matern32''matern52'
%'rationalquadratic''ardexponential''ardsquaredexponential'
%'ardmatern32''ardmatern52''ardrationalquadratic'


ypred = resubPredict(gprMdl);

figure(1);
plot(Tb.ST,'r.');
hold on
plot(ypred,'b');
xlabel('data');
ylabel('Settling time');
legend({'data','predictions'},'Location','Best');
hold off;

figure(2);
d=reshape(ypred,10,10);
e=reshape(ST,10,10);

surf(e,'SpecularExponent',1,...
    'SpecularStrength',1,...
    'DiffuseStrength',1,...
    'AmbientStrength',0.4,...
    'FaceColor',[1 0 0],...
    'AlignVertexCenters','on',...
    'LineWidth',0.2,...
    'EdgeAlpha',1);
hold on
%surf 2
surf(d,'SpecularExponent',1,...
    'SpecularStrength',1,...
    'DiffuseStrength',1,...
    'AmbientStrength',0.4,...
    'FaceColor',[0 0 1],...
    'AlignVertexCenters','on',...
    'LineWidth',0.2,...
    'EdgeAlpha',1);
legend({'data','predictions'},'Location','Best');
hold off

min(ypred)
min(ST)
